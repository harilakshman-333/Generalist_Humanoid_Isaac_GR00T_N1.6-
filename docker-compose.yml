version: '3.8'

services:
  isaac-lab:
    build:
      context: .
      dockerfile: docker/Dockerfile.isaac_lab
    image: humanoid-generalist/isaac-lab:latest
    runtime: nvidia
    environment:
      - ACCEPT_EULA=Y
      - NVIDIA_VISIBLE_DEVICES=all
      - NVIDIA_DRIVER_CAPABILITIES=all
    volumes:
      - ./isaac_lab:/workspace/isaac_lab
      - ./compass_nav:/workspace/compass_nav
    command: /bin/bash

  localization:
    build:
      context: .
      dockerfile: docker/Dockerfile.localization
    image: humanoid-generalist/localization:latest
    runtime: nvidia
    environment:
      - ACCEPT_EULA=Y
      - NVIDIA_VISIBLE_DEVICES=all
      - NVIDIA_DRIVER_CAPABILITIES=all
      - RMW_IMPLEMENTATION=rmw_cyclonedds_cpp
    volumes:
      - ./localization:/ros2_ws/src/localization
    command: /bin/bash

  gr00t:
    image: nvcr.io/nvidia/pytorch:23.10-py3 # Placeholder base image
    runtime: nvidia
    environment:
      - ACCEPT_EULA=Y
      - NVIDIA_VISIBLE_DEVICES=all
    volumes:
      - ./gr00t_model:/workspace/gr00t_model
    command: python3 /workspace/gr00t_model/run_inference.py
